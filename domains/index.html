<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Domains — Megaladon Hosting</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/images/favicon-32.png">
    <link rel="apple-touch-icon" href="../assets/images/favicon-64.png">
    <link rel="stylesheet" href="../assets/css/styles.css">
  </head>
  <body class="dark">
    <header class="site-header sticky">
      <div class="container header-row">
        <a class="logo" href="../index.html">
          <img class="logo-img" src="../assets/images/shark.jpg" alt="Megaladon Hosting logo" onerror="this.onerror=null;this.src='../assets/images/logo-placeholder.svg'"/>
          <span class="logo-text">Megaladon Hosting</span>
        </a>
        <nav class="nav">
          <a href="../index.html">Home</a>
          <a href="../pricing/index.html">Pricing</a>
          <a href="index.html" aria-current="page">Domains</a>
          <a href="../about/index.html">About</a>
          <a href="../support/index.html">Support</a>
        </nav>
        <button id="navToggle" class="nav-toggle" aria-label="Toggle navigation" aria-expanded="false">☰</button>
        <div class="header-cta">
          <a class="btn btn-ghost" data-whmcs-client>Login</a>
          <a class="btn btn-primary" href="../pricing/index.html">Get Hosting</a>
        </div>
      </div>
    </header>

    <main class="container" style="padding-top:36px;padding-bottom:40px">
      <h1>Domain Search</h1>
      <p class="sub">Search and register thousands of TLDs. Search real availability with your WHMCS domain checker.</p>

      <form id="domainFormTop" class="domain-form" style="margin:14px 0;" action="." method="get">
        <input id="domainInputTop" name="q" type="text" placeholder="yourperfectsite" aria-label="domain" />
        <select id="tldSelectTop" aria-label="tld">
          <option value=".com">.com</option>
          <option value=".net">.net</option>
          <option value=".org">.org</option>
          <option value=".io">.io</option>
        </select>
        <button type="submit" class="btn btn-cta">Search Domains</button>
      </form>

      <div id="results"></div>

      <h3 style="margin-top:22px">Popular TLD pricing</h3>
      <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:12px">
        <div class="card" style="padding:12px;min-width:160px">.com — <strong>$12.99</strong></div>
        <div class="card" style="padding:12px;min-width:160px">.net — <strong>$13.99</strong></div>
        <div class="card" style="padding:12px;min-width:160px">.org — <strong>$11.99</strong></div>
        <div class="card" style="padding:12px;min-width:160px">.io — <strong>$28.00</strong></div>
      </div>

    </main>

    <footer class="site-footer">
      <div class="container footer-grid"><div class="brand">Megaladon Hosting</div><nav class="footer-nav"><a href="../index.html">Home</a><a href="../pricing/index.html">Pricing</a><a href="../support/index.html">Support</a></nav><div class="copyright">© <span id="year"></span> Megaladon</div></div>
    </footer>

    <script src="../assets/js/config.js"></script>
    <script>
      // If ?q= is present we show a local simulated results UI and links to WHMCS naming pattern.
      (function(){
        function getQueryParam() { var u = new URL(location.href); return u.searchParams.get('q'); }
        var q = getQueryParam();
        if(!q) return;
        var results = document.getElementById('results');
        var name = q.replace(/\..*/,'');
        var tlds = ['com','net','org','io','dev','cloud'];

        // simple deterministic availability used as initial state
        function deterministicAvailable(domain){
          var hash = 0; for(var i=0;i<domain.length;i++){ hash = ((hash<<5)-hash) + domain.charCodeAt(i); hash = hash & hash; }
          return Math.abs(hash) % 3 !== 0;
        }

        var priceMap = {com:12.99, net:13.99, org:11.99, io:28.00, dev:15.00, cloud:9.99};

        var html = '<h3>Search results for "' + q + '"</h3>'
                 + '<div style="margin-top:8px;display:grid;grid-template-columns:1fr 160px 160px;gap:8px;align-items:center;padding:10px 12px;border-radius:8px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));font-weight:600;color:var(--muted)">' 
                 + '<div>Domain</div><div>Price</div><div style="text-align:right">Action</div></div>'
                 + '<div style="margin-top:8px">';

        tlds.forEach(function(t){
          var domain = name + '.' + t;
          var available = deterministicAvailable(domain);
          var price = (priceMap[t] !== undefined) ? ('$' + priceMap[t].toFixed(2)) : '-';

          // Build a single row with a data attribute to allow later updates via the lookup proxy.
          html += '<div data-domain-full="'+domain+'" style="display:grid;grid-template-columns:1fr 160px 160px;gap:8px;align-items:center;margin-bottom:8px;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.02);background:var(--panel)">'
                + '<div style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap">'+domain+'</div>';

          if(available){
            var cfg = (window.MEGALADON || {});
            var base = cfg.whmcsBase || '';
            var registerHref = '/cart.php?domain=' + encodeURIComponent(name) + '&tld=' + encodeURIComponent(t);
            html += '<div style="width:140px;color:var(--success)">' + price + '</div>'
                 + '<div style="text-align:right"><a class="btn btn-primary" href="'+registerHref+'">Register</a></div>';
          } else {
            var cfg = (window.MEGALADON || {});
            var template = cfg.domainSearchTemplate || '/domainchecker.php?search={query}';
            var base = cfg.whmcsBase || '';
            var encoded = encodeURIComponent(domain);
            var lookupHref = /^https?:\/\//i.test(template) ? template.replace('{query}', encoded) : base.replace(/\/$/, '') + template.replace('{query}', encoded);
            html += '<div style="width:140px;color:var(--muted)">' + price + '</div>'
                 + '<div style="text-align:right"><a class="btn btn-ghost" href="'+lookupHref+'" target="_blank" rel="noopener">Check in WHMCS</a></div>';
          }

          html += '</div>';
        });

        html += '</div>';
        results.innerHTML = html;

        // After initial render, attempt to update availability using a local lookup proxy at /lookup
        try {
          var rows = results.querySelectorAll('[data-domain-full]');
          rows.forEach(function(row){
            var domainFull = row.getAttribute('data-domain-full');
            fetch('/lookup?domain=' + encodeURIComponent(domainFull)).then(function(resp){
              if(!resp.ok) throw new Error('no proxy');
              return resp.json();
            }).then(function(json){
              if(!json || !json.status) return;
              var actionAnchor = row.querySelector('div:nth-child(3) a');
              if(json.status === 'available'){
                var cfg = (window.MEGALADON || {});
                var base = cfg.whmcsBase || '';
                var parts = domainFull.split('.');
                var namePart = parts.shift();
                var tldPart = parts.join('.');
                var href = '/cart.php?domain=' + encodeURIComponent(namePart) + '&tld=' + encodeURIComponent(tldPart);
                if(actionAnchor){ actionAnchor.className = 'btn btn-primary'; actionAnchor.href = href; actionAnchor.textContent = 'Register'; }
              } else if(json.status === 'taken'){
                var cfg = (window.MEGALADON || {});
                var template = cfg.domainSearchTemplate || '/domainchecker.php?search={query}';
                var base = cfg.whmcsBase || '';
                var lookupHref = /^https?:\/\//i.test(template) ? template.replace('{query}', encodeURIComponent(domainFull)) : base.replace(/\/$/, '') + template.replace('{query}', encodeURIComponent(domainFull));
                if(actionAnchor){ actionAnchor.className = 'btn btn-ghost'; actionAnchor.href = lookupHref; actionAnchor.textContent = 'Check in WHMCS'; }
              }
            }).catch(function(){ /* keep the simulated state if proxy unavailable */ });
          });
        } catch(e){}

      })();
    </script>
    <script src="../assets/js/main.js"></script>

  </body>
</html>
